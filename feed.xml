<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="https://addcnin.blue/feed.xml" rel="self" type="application/atom+xml" /><link href="https://addcnin.blue/" rel="alternate" type="text/html" /><updated>2020-04-16T16:34:24-07:00</updated><id>https://addcnin.blue/feed.xml</id><title type="html">Addison Chan</title><subtitle>Addison Chan | CS &amp; Stats @ UC Berkeley.</subtitle><author><name>@addcninblue</name></author><entry><title type="html">Covid-19 and Game Theory</title><link href="https://addcnin.blue/2020/04/16/game-theory-covid-19/" rel="alternate" type="text/html" title="Covid-19 and Game Theory" /><published>2020-04-16T00:00:00-07:00</published><updated>2020-04-16T00:00:00-07:00</updated><id>https://addcnin.blue/2020/04/16/game-theory-covid-19</id><content type="html" xml:base="https://addcnin.blue/2020/04/16/game-theory-covid-19/">&lt;p&gt;With the Coronavirus, tissue paper and supplies are flying out of stores. Some argue that it’s a natural human reaction best explained by Game Theory. In this essay, I will explore these claims, as well as how several countries have responded differently, and how their policies can be explained by Game Theory.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;N.B.: This post was originally the essay for one of my Stat 155 assignments. I thought it interesting enough to share on my blog – I hope you enjoy it!&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;articles-referenced-and-their-claims&quot;&gt;Articles Referenced and Their Claims&lt;/h2&gt;
&lt;p&gt;In The Herald&lt;sup id=&quot;fnref:The-Herald&quot;&gt;&lt;a href=&quot;#fn:The-Herald&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;, the Adam Smith Institute&lt;sup id=&quot;fnref:Adam-Smith-Institute&quot;&gt;&lt;a href=&quot;#fn:Adam-Smith-Institute&quot; class=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;, and Asia Times&lt;sup id=&quot;fnref:Asia-Times&quot;&gt;&lt;a href=&quot;#fn:Asia-Times&quot; class=&quot;footnote&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;, the authors argue that the situation is well-explained by Prisoners’ Dilemma. In The Herald, McArdle makes the additional claim that Western countries have a lack of trust that Eastern countries do not have, exacerbating the Prisoners’ Dilemma problem. Macdonald of the Adam Smith Institute makes a particularly astute economic observation that “raising prices in our current context is not a cynical cash grab, but an effective means of restoring consumer confidence and ensuring we can all access the goods we need during these strange and difficult times”.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;A minor charge can be compared to temporary economic and material disruption. That would have been the sole significant setback had corporations cooperated. In this case the entire economic machinery would have toned down and shrunk, and thus everyone would have been affected more or less the same.&lt;/p&gt;

  &lt;p&gt;The problem, however, arises when some parties betray the faith. From a single corporation’s or businessman’s point of view, if they stay faithful, and other parties do not adhere to the bargain, they fall back in the competition. The disadvantage sustained could very plausibly be insurmountable, akin to one prisoner walking off free while the other suffers a massive loss.&lt;/p&gt;

  &lt;p&gt;– Kaushik, Asia Times&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;In &lt;a href=&quot;https://medium.com/@vivfang/coronavirus-game-6fdf4d4d4007&quot;&gt;an article published on Medium&lt;/a&gt;, Fang tackles a popular post floating on Facebook claiming to explain the Coronavirus in terms of Game Theory by arguing that the explanation was flawed due to a wrong application of said theory. Fang then reproduces the game, this time with her own chart. Noticeably, the chart, reproduced below, has a Nash Equilibrium that is Pareto Efficient!
&lt;img src=&quot;/assets/posts/2020-04-16-game-theory-covid-19/medium-article-chart.png&quot; alt=&quot;Medium Article Chart&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;prisoners-dilemma&quot;&gt;Prisoners’ Dilemma&lt;/h2&gt;
&lt;p&gt;But are we as humans really stuck in a game of Prisoners’ Dilemma? Seeing that several Asian countries, and Taiwan in particular, have no issues with hoarding, we must either settle for the conclusion that humans are fundamentally different across the East and the West, as McArdle claims, or that there is some other factor at play &lt;em&gt;impacting the setup of the game itself&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;In the situation where the setup of the games are the same, where both the East and West are facing Prisoners’ Dilemmas, the lack of shortages in the East would mean that the people are cooperating. While plausible, these differences must necessarily be attributed to a difference in culture, meaning that scarcity would manifest differently across the United States. Seeing that communities everywhere see shortages, there must be some other explanation.&lt;/p&gt;

&lt;p&gt;Suppose for a moment that supplies are not scarce; ie. no matter how much toilet paper one buys, another will not be impacted. Denote the payoff of hoarding to be &lt;script type=&quot;math/tex&quot;&gt;-5&lt;/script&gt; due to diminishing returns, and the payoff of not hoarding to be &lt;script type=&quot;math/tex&quot;&gt;0&lt;/script&gt;.&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{bmatrix}
P1 \textrm{\\} P2&amp; \textrm{hoard} &amp; \textrm{don't hoard} \\
\textrm{hoard}       &amp; (-5, -5) &amp; (-5, 0) \\
\textrm{don't hoard} &amp; (0, -5)  &amp; (0, 0) \\
\end{bmatrix} %]]&gt;&lt;/script&gt;

&lt;p&gt;In this setup, we immediately see that the Prisoners’ Dilemma problem has disappeared – &lt;script type=&quot;math/tex&quot;&gt;\textrm{(don't hoard, don't hoard)}&lt;/script&gt; is the Nash Equilibrium &lt;em&gt;and the Pareto Optimum&lt;/em&gt;, meaning that with a lack of resources, there is no incentive for anyone to hoard resources! This makes sense – why hoard knowing that resources will always be available when you need it?&lt;/p&gt;

&lt;h2 id=&quot;response-to-the-coronavirus&quot;&gt;Response to the Coronavirus&lt;/h2&gt;
&lt;p&gt;Let us take a step back and view responses to the coronavirus; in particular, we compare Taiwan’s&lt;sup id=&quot;fnref:wikipedia-taiwan&quot;&gt;&lt;a href=&quot;#fn:wikipedia-taiwan&quot; class=&quot;footnote&quot;&gt;4&lt;/a&gt;&lt;/sup&gt; approach to the United States’&lt;sup id=&quot;fnref:wikipedia-usa&quot;&gt;&lt;a href=&quot;#fn:wikipedia-usa&quot; class=&quot;footnote&quot;&gt;5&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;

&lt;p&gt;On December 31st, 2019, both the United States and Taiwan learned about the cases in China. On that same day, Taiwan started inspecting inbound flights from Wuhan, while the United States waited until much much later. Mask rationing was implemented on February 6th, with the Taiwanese Armed Forces deployed to aid the scaling of mask production in factories. In the United States, people were recommended to not wear masks, claiming that their efficacy was unproven and limited. In the third week of February, medical experts “concluded that the United States had already lost the fight to contain the virus”.[^nytimes-red-dawn] Contrasting this is the efforts of Taiwan, who as of today only have a mere 395 cases (fewer than my county!) and are exporting face masks!&lt;/p&gt;

&lt;p&gt;Arguments as to why Taiwan and other countries’ responses have been so quick are varied, including the fact that they have seen SARS, a similar virus and situation, but one thing is clear: their people have much less to fear when they know that containment is quite evident and adequate. This effectively reduces their situation to the lack of shortage situation discussed earlier, since they can depend on supply chains not shutting down because of adequate preparation.&lt;/p&gt;

&lt;h2 id=&quot;facing-the-shortages&quot;&gt;Facing the Shortages&lt;/h2&gt;
&lt;blockquote&gt;
  &lt;p&gt;But are people acting irrationally? At a collective level, it is leading to shortages of goods. But in a direct sense, people are acting rationally. It becomes optimal rather than suboptimal to start stockpiling if everyone else does because their stockpiling creates the very supply problem they are trying to avoid in the first place.&lt;/p&gt;

  &lt;p&gt;– Macdonald, Adam Smith Institute&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;I was an intended Economics major prior to switching to Statistics. Macdonald’s claim piqued my interest, so let’s examine them through a statistical lens.&lt;/p&gt;

&lt;p&gt;In the situation where market values are not restricted, we have the following payoff diagram: In the case where people both do not hoard, there is no change from the status quo, so the payoff to both is 0. In the case where one hoards and the other doesn’t, one gains and the other loses. In the case where both hoard, there is a small loss to both (since there is a loss of accessible resources in the case either need them). This is classical Prisoners’ Dilemma:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{bmatrix}
P1 \textrm{\\} P2&amp; \textrm{hoard} &amp; \textrm{don't hoard} \\
\textrm{hoard}       &amp; (-2, -2) &amp; (3, -3) \\
\textrm{don't hoard} &amp; (-3, 3)  &amp; (0, 0) \\
\end{bmatrix} %]]&gt;&lt;/script&gt;

&lt;p&gt;Now, suppose there is a price floor imposed on the market, equivalent to the total marginal utility gained through hoarding beyond the original market equilibrium. The scenario is the same, with one changed parameter: hoarding is more expensive now, incurring a loss of &lt;script type=&quot;math/tex&quot;&gt;-3&lt;/script&gt;. We define a new field, &lt;script type=&quot;math/tex&quot;&gt;\textrm{hoard less}&lt;/script&gt;, describing a situation where hoarding is in effect, but with less quantity. Assuming that both people have a price-elastic response&lt;sup id=&quot;fnref:price-elasticity&quot;&gt;&lt;a href=&quot;#fn:price-elasticity&quot; class=&quot;footnote&quot;&gt;6&lt;/a&gt;&lt;/sup&gt;:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{bmatrix}
P1 \textrm{\\} P2&amp; \textrm{hoard} &amp; \textrm{don't hoard} \\
\textrm{hoard}       &amp; (-5, -5) &amp; (0, -3) \\
\textrm{don't hoard} &amp; (-3, 0)  &amp; (0, 0) \\
\end{bmatrix} %]]&gt;&lt;/script&gt;

&lt;p&gt;Immediately, we see that we have recovered a situation with the Nash Equilibrium equal to the Pareto Equilibrium equal to not hoarding for both. In other words, the market price floor has a positive effect in this scenario.&lt;/p&gt;

&lt;h2 id=&quot;footnotes&quot;&gt;Footnotes&lt;/h2&gt;

&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:The-Herald&quot;&gt;
      &lt;p&gt;https://www.heraldscotland.com/news/18314703.helen-mcardle-game-theory-tells-us-britains-reaction-coronavirus/ &lt;a href=&quot;#fnref:The-Herald&quot; class=&quot;reversefootnote&quot;&gt;⤴&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:Adam-Smith-Institute&quot;&gt;
      &lt;p&gt;https://www.adamsmith.org/blog/covid-19-and-game-theory &lt;a href=&quot;#fnref:Adam-Smith-Institute&quot; class=&quot;reversefootnote&quot;&gt;⤴&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:Asia-Times&quot;&gt;
      &lt;p&gt;https://asiatimes.com/2020/03/covid-19-and-the-prisoners-dilemma/ &lt;a href=&quot;#fnref:Asia-Times&quot; class=&quot;reversefootnote&quot;&gt;⤴&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:wikipedia-taiwan&quot;&gt;
      &lt;p&gt;https://en.wikipedia.org/wiki/2020_coronavirus_pandemic_in_Taiwan &lt;a href=&quot;#fnref:wikipedia-taiwan&quot; class=&quot;reversefootnote&quot;&gt;⤴&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:wikipedia-usa&quot;&gt;
      &lt;p&gt;https://en.wikipedia.org/wiki/Timeline_of_the_2020_coronavirus_pandemic_in_the_United_States &lt;a href=&quot;#fnref:wikipedia-usa&quot; class=&quot;reversefootnote&quot;&gt;⤴&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:price-elasticity&quot;&gt;
      &lt;p&gt;Here, I make a key assumption that price elasticity of hoarded goods are elastic beyond their basic consumption. The author of the Adam Smith Institute article, Macdonald, has observed anecdotally that his experience supports this conclusion. &lt;a href=&quot;#fnref:price-elasticity&quot; class=&quot;reversefootnote&quot;&gt;⤴&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name>@addcninblue</name></author><summary type="html">With the Coronavirus, tissue paper and supplies are flying out of stores. Some argue that it’s a natural human reaction best explained by Game Theory. In this essay, I will explore these claims, as well as how several countries have responded differently, and how their policies can be explained by Game Theory.</summary></entry><entry><title type="html">Homelab with NixOS, Jupyter, and More</title><link href="https://addcnin.blue/2020/04/13/homelab/" rel="alternate" type="text/html" title="Homelab with NixOS, Jupyter, and More" /><published>2020-04-13T00:00:00-07:00</published><updated>2020-04-13T00:00:00-07:00</updated><id>https://addcnin.blue/2020/04/13/homelab</id><content type="html" xml:base="https://addcnin.blue/2020/04/13/homelab/">&lt;p&gt;For half a year (and more), I’ve been thinking about building a computer to learn and train ML models on, as well as to host my web applications on. Over this past half month, I finally bit the bullet, opting for a Ryzen 3700X paired with an Nvidia 1080 Ti. The full parts list can be found &lt;a href=&quot;https://pcpartpicker.com/user/addcn/saved/kfN2Vn&quot;&gt;here&lt;/a&gt;. I chose to install &lt;a href=&quot;https://nixos.org/&quot;&gt;NixOS&lt;/a&gt;, a declarative operating system, and this post outlines the full software-side process, including several hurdles I came across.&lt;/p&gt;

&lt;h2 id=&quot;rationale-for-parts&quot;&gt;Rationale For Parts&lt;/h2&gt;
&lt;p&gt;I chose a 3700X mainly for the insane number of cores, as hosting several concurrent applications would require a lot of multithreading. I considered the 3600, and I figured the increase in cores was worth the small bump in price. For the GPU, I debated between the 1080 Ti and a 2070 Super, and I eventually opted for the 1080 Ti for the increased memory, figuring that the FP16 performance wouldn’t be seen by me (at least not for a while). (Later on in the month, my neighbor gave me an old computer, and I found a 1080 inside. I’m extremely lucky and grateful for him :’).) The main hard drive is an NVMe SSD. The hard drives are used Barracuda drives, and will be purchased off of Craigslist. Eventually, once the coronavirus wave passes and I purchase the hard drives, I will use &lt;a href=&quot;https://www.kernel.org/doc/Documentation/bcache.txt&quot;&gt;bcache&lt;/a&gt; to turn the SSD into a caching layer, with the main memory on the hard drives. The configuration will use LVM on top of software RAID 6, so that storage is very easily configurable and reliable.&lt;/p&gt;

&lt;h2 id=&quot;nixos&quot;&gt;NixOS&lt;/h2&gt;
&lt;p&gt;NixOS installation is pretty straightforward. Their &lt;a href=&quot;https://nixos.wiki/wiki/NixOS_Installation_Guide&quot;&gt;guide&lt;/a&gt; is very well written, so I defer to them for installation instructions. My dotfiles can be found &lt;a href=&quot;https://github.com/addcninblue/dotfiles/tree/nixos&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;jupyterhub&quot;&gt;JupyterHub&lt;/h2&gt;
&lt;p&gt;Since I would be doing a decent amount of computation, and since my main laptop is a Pixelbook, I wanted to be able to have access to a Python interpreter anywhere, particularly hosted on a website. As a result, I decided to use &lt;a href=&quot;https://jupyterhub.readthedocs.io/en/stable/&quot;&gt;Jupyterhub&lt;/a&gt;, which is pretty stable and has really good documentation. I set up the installation in an LXC container running Ubuntu 18.04, following the instructions &lt;a href=&quot;https://jupyterhub.readthedocs.io/en/stable/installation-guide-hard.html&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Installing new kernels for JupyterHub was a huge headache, however. There are a lot of package managers for Python, including &lt;code class=&quot;highlighter-rouge&quot;&gt;virtualenv&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;venv&lt;/code&gt;, and &lt;code class=&quot;highlighter-rouge&quot;&gt;conda&lt;/code&gt;, and often their usages overlap with one another. Maintaining them is quite the headache! For JupyterHub, &lt;code class=&quot;highlighter-rouge&quot;&gt;conda&lt;/code&gt; is used to make environments, and &lt;em&gt;kernels&lt;/em&gt; are used when executing code inside JupyterHub. Below is a detailed rundown of creation of a new conda environment for a particular user:&lt;/p&gt;

&lt;h3 id=&quot;creating-a-new-environment&quot;&gt;Creating a New Environment&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;First, we create the &lt;code class=&quot;highlighter-rouge&quot;&gt;conda&lt;/code&gt; environment. Here, our conda environment is called &lt;code class=&quot;highlighter-rouge&quot;&gt;conda_env&lt;/code&gt; and we install the &lt;code class=&quot;highlighter-rouge&quot;&gt;ipykernel&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;matplotlib&lt;/code&gt; packages. You can choose your packages, but note that &lt;code class=&quot;highlighter-rouge&quot;&gt;ipykernel&lt;/code&gt; &lt;em&gt;must&lt;/em&gt; be installed: &lt;code class=&quot;highlighter-rouge&quot;&gt;conda create --name &quot;conda_env&quot; python=3.7 ipykernel matplotlib&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Next, we activate the conda environment: &lt;code class=&quot;highlighter-rouge&quot;&gt;conda activate conda_env&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Now, since we have our conda environment activated, the &lt;code class=&quot;highlighter-rouge&quot;&gt;python&lt;/code&gt; binary will be bound to the &lt;code class=&quot;highlighter-rouge&quot;&gt;python&lt;/code&gt; package that the &lt;code class=&quot;highlighter-rouge&quot;&gt;conda&lt;/code&gt; environment created. (You can use &lt;code class=&quot;highlighter-rouge&quot;&gt;which python&lt;/code&gt; to see that in action!) Now, we can use &lt;code class=&quot;highlighter-rouge&quot;&gt;python -m ipykernel install --user --name &quot;kernel_name&quot;&lt;/code&gt; to install a new kernel with the name &lt;code class=&quot;highlighter-rouge&quot;&gt;kernel_name&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;listing-environments&quot;&gt;Listing Environments&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Listing &lt;code class=&quot;highlighter-rouge&quot;&gt;conda&lt;/code&gt; environments: &lt;code class=&quot;highlighter-rouge&quot;&gt;conda info --envs&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Listing JupyterHub kernels: &lt;code class=&quot;highlighter-rouge&quot;&gt;jupyter kernelspec list&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;deleting-kernels-and-conda-environments&quot;&gt;Deleting Kernels and Conda Environments&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;First, we remove the jupyter kernel: &lt;code class=&quot;highlighter-rouge&quot;&gt;jupyter kernelspec remove &quot;kernel_name&quot;&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Next, we remove the conda environment that created the kernel: &lt;code class=&quot;highlighter-rouge&quot;&gt;conda remove --name &quot;conda_env&quot; --all&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;bonus-installing-packages-from-requirementstxt&quot;&gt;Bonus: Installing Packages From requirements.txt&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Follow steps from &lt;a href=&quot;#creating-a-new-environment&quot;&gt;&lt;strong&gt;Creating a New Environment&lt;/strong&gt;&lt;/a&gt;, but before installing the kernel, run &lt;code class=&quot;highlighter-rouge&quot;&gt;conda install --file requirements.txt&lt;/code&gt; to install the packages to the &lt;code class=&quot;highlighter-rouge&quot;&gt;conda&lt;/code&gt; environment. Then, proceed as usual.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;making-lxc-play-nice&quot;&gt;Making LXC Play Nice&lt;/h2&gt;
&lt;p&gt;The last thing I needed to do to make the container GPU-accelerated was to pass the GPU through as a device from the host OS to the container. It was definitely not trivial.&lt;/p&gt;

&lt;h3 id=&quot;gpu-passthrough&quot;&gt;GPU Passthrough&lt;/h3&gt;
&lt;p&gt;This was by far the most annoying part of this build. Stéphane Graber’s blog has a very very well written &lt;a href=&quot;https://stgraber.org/2017/03/21/cuda-in-lxd/&quot;&gt;post&lt;/a&gt; about how to get GPU passthrough to work, but since I am using different operating systems, I will highlight some things that might trip others up:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;The Nvidia driver version &lt;em&gt;must be exactly the same&lt;/em&gt;. &lt;strong&gt;This includes the minor version!&lt;/strong&gt; A driver mismatch will cause you endless pain and suffering. For those who are venturing down this path, I recommend to first install the host Nvidia driver and CUDA driver, and then download matching versions for the LXC client.&lt;/li&gt;
  &lt;li&gt;When you install the &lt;code class=&quot;highlighter-rouge&quot;&gt;.run&lt;/code&gt; Nvidia driver on the LXC client, you might run into something along the lines of “xxx kernel module is already installed”. To fix this, append &lt;code class=&quot;highlighter-rouge&quot;&gt;--no-kernel-module&lt;/code&gt; to the script (so it looks something like &lt;code class=&quot;highlighter-rouge&quot;&gt;sudo sh NVIDIA-Linux-x86_64-440.36.run --no-kernel-module&lt;/code&gt;). I don’t fully understand this, but my understanding is that since LXC containers use the host kernel, the module is getting loaded by the host operating system, so the kernel module doesn’t need to be installed by the guest container. Here, that would mean that we would only need to install the driver for the tools, not for the kernel module).&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;bind-mounting-folders&quot;&gt;Bind-Mounting Folders&lt;/h3&gt;
&lt;p&gt;The next thing I wanted to do was to bind-mount folders from my host operating system into the container to be accessible by JupyterHub. Since the installation of JupyterHub meant that each user would get their own home folder, I figured bind-mounting home from the host operating system to home on the container would be trivial. As all things go, it wasn’t.&lt;/p&gt;

&lt;p&gt;Again, Stéphane Graber’s blog has another &lt;a href=&quot;https://stgraber.org/2017/06/15/custom-user-mappings-in-lxd-containers/&quot;&gt;post&lt;/a&gt; on getting user mappings working in containers. This time, I didn’t run into particular issues, and following his mappings worked very well.&lt;/p&gt;

&lt;h2 id=&quot;todo-raid-lvm-and-bcache&quot;&gt;TODO: RAID, LVM, and Bcache&lt;/h2&gt;
&lt;p&gt;Once the coronavirus situation dies down, I will be able to purchase the hard drives, and I will edit this part with the installation process.&lt;/p&gt;

&lt;h2 id=&quot;some-screenshots&quot;&gt;Some Screenshots&lt;/h2&gt;
&lt;p&gt;Jupyterhub up and running:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/homelab/jupyter.png&quot; alt=&quot;jupyterhub&quot; /&gt;&lt;/p&gt;</content><author><name>@addcninblue</name></author><summary type="html">For half a year (and more), I’ve been thinking about building a computer to learn and train ML models on, as well as to host my web applications on. Over this past half month, I finally bit the bullet, opting for a Ryzen 3700X paired with an Nvidia 1080 Ti. The full parts list can be found here. I chose to install NixOS, a declarative operating system, and this post outlines the full software-side process, including several hurdles I came across.</summary></entry><entry><title type="html">P/NP and Game Theory</title><link href="https://addcnin.blue/2020/04/05/pnp-game-theory/" rel="alternate" type="text/html" title="P/NP and Game Theory" /><published>2020-04-05T00:00:00-07:00</published><updated>2020-04-05T00:00:00-07:00</updated><id>https://addcnin.blue/2020/04/05/pnp-game-theory</id><content type="html" xml:base="https://addcnin.blue/2020/04/05/pnp-game-theory/">&lt;p&gt;In light of the recent changes of UC Berkeley’s grading scheme to P/NP, it’s quite interesting to examine the problem of grading through a Game Theoretic perspective. Lots of students have proposed that the change to an online format &lt;em&gt;encourages cheating&lt;/em&gt;, and that the curves for this semester will change drastically as a result. In this essay, I hope to explore this claim and test its validity.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;N.B.: This post was originally the essay for one of my Stat 155 assignments. I thought it interesting enough to share on my blog – I hope you enjoy it!&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;uc-zoom&quot;&gt;UC Zoom&lt;/h2&gt;

&lt;p&gt;On Friday, March 13th, classes were officially moved online by the UC Berkeley Administration. At this point, the change to the grading rubric had not been made yet. Let us model a typical Computer Science class, where grades are curved to a B+, as an n-player zero-sum game&lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt; (with zero being the mean, and each integer difference being one standard deviation). To simplify this, we examine the two-player zero-sum game, which is well-studied.&lt;/p&gt;

&lt;p&gt;The game is modeled as follows, with each student having two possibilities, &lt;code class=&quot;highlighter-rouge&quot;&gt;cheat&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;honest&lt;/code&gt;. We assume that the students are of equal skill, and that cheating gives a &lt;script type=&quot;math/tex&quot;&gt;+1&lt;/script&gt; standard deviation edge. Being caught in a class is &lt;script type=&quot;math/tex&quot;&gt;-0.12&lt;/script&gt;&lt;sup id=&quot;fnref:cheating-payoff&quot;&gt;&lt;a href=&quot;#fn:cheating-payoff&quot; class=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;. Payoffs are written to row, who is &lt;script type=&quot;math/tex&quot;&gt;A&lt;/script&gt; in this case:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{bmatrix}
A \textrm{\\} B &amp; \mathrm{cheat} &amp; \mathrm{honest} \\
\mathrm{cheat} &amp; 0 &amp; 0.88 \\
\mathrm{honest} &amp; -0.88 &amp; 0 \\
\end{bmatrix} %]]&gt;&lt;/script&gt;

&lt;p&gt;We see &lt;script type=&quot;math/tex&quot;&gt;\mathrm{(cheat, cheat)}&lt;/script&gt; is the dominant strategy, meaning in the case of letter grading, our model tells us that students do in fact have an incentive to cheat.&lt;sup id=&quot;fnref:2&quot;&gt;&lt;a href=&quot;#fn:2&quot; class=&quot;footnote&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;h2 id=&quot;campuswide-pnp-policy&quot;&gt;Campuswide P/NP Policy&lt;/h2&gt;
&lt;p&gt;With the campuswide P/NP policy in place, the incentive to cheat is suddenly changed. In the CS department, it is yet unclear how grades will be assigned, but taking that a C- minimum is required to get a passing grade, one can do several standard deviations below mean and still pass in the class. Looking at grade distributions of a large CS class (&lt;script type=&quot;math/tex&quot;&gt;N &gt; 19000&lt;/script&gt;), historic grades have told us that C- and up covers 95% of the population&lt;sup id=&quot;fnref:berkeleytime&quot;&gt;&lt;a href=&quot;#fn:berkeleytime&quot; class=&quot;footnote&quot;&gt;4&lt;/a&gt;&lt;/sup&gt;. Therefore, in a game where two students are both taking the course for P/NP credit, modeling the grade distributions off of a large CS class, there seems to be very low incentive for anyone to cheat. Regardless of whether or not they cheat, they will more than likely make the cutoff if they put enough effort into the class, and cheating only gives the extra possibility of getting caught. Therefore, with P/NP, it seems that &lt;em&gt;the incentive for cheating decreases&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;This time, the game is modeled as a general-sum game, since one person doing well has a negligible impact on another. We only look at the payout of one person, since in the n-person general-sum game, everyone has a symmetric payout.&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{bmatrix}
\mathrm{cheat} &amp; \mathrm{honest} \\
0 + \epsilon &amp; 0 \\
\end{bmatrix} %]]&gt;&lt;/script&gt;

&lt;h2 id=&quot;banning-proctoring-over-zoom&quot;&gt;Banning Proctoring Over Zoom&lt;/h2&gt;
&lt;p&gt;With the ban of proctoring, the risk of getting caught for cheating is all but zeroed. Does this impact the risk of cheating?&lt;/p&gt;

&lt;p&gt;With the Zoom ban, many CS classes have shifted to an open-book policy. This means that, effectively, everything in the test can be looked up either way. As a result, while cheating is easily doable, with other mitigations such as test randomization, it seems that there is little impact on the rate of cheating. We get the same chart, after adding the ease of cheating and subtracting the hoops needed to hop through to cheat.&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{bmatrix}
\mathrm{cheat} &amp; \mathrm{honest} \\
0 + \epsilon &amp; 0 \\
\end{bmatrix} %]]&gt;&lt;/script&gt;

&lt;h2 id=&quot;footnotes&quot;&gt;Footnotes&lt;/h2&gt;

&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:1&quot;&gt;
      &lt;p&gt;A brief note about the choice of zero-sum versus general-sum: Since classes in the CS department are all curved, this would mean that, if we took two students &lt;script type=&quot;math/tex&quot;&gt;A&lt;/script&gt; and &lt;script type=&quot;math/tex&quot;&gt;B&lt;/script&gt;, fixing &lt;script type=&quot;math/tex&quot;&gt;A&lt;/script&gt;’s performance would mean that &lt;script type=&quot;math/tex&quot;&gt;B&lt;/script&gt; doing better causes &lt;script type=&quot;math/tex&quot;&gt;A&lt;/script&gt; to get a worse grade. We see that in the two-player scenario, since their grades must average to the same grade, &lt;script type=&quot;math/tex&quot;&gt;B&lt;/script&gt; getting &lt;script type=&quot;math/tex&quot;&gt;+d&lt;/script&gt; standard deviations would result in &lt;script type=&quot;math/tex&quot;&gt;A&lt;/script&gt; getting &lt;script type=&quot;math/tex&quot;&gt;-d&lt;/script&gt;. This is a zero-sum game. &lt;a href=&quot;#fnref:1&quot; class=&quot;reversefootnote&quot;&gt;⤴&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:cheating-payoff&quot;&gt;
      &lt;p&gt;Suppose 1 in every 50 students are caught for cheating. (This amounts to 2%.) Empirically, we have no data for cheating, since it would require all students to admit their cheating, which is somewhat of a catch-22. Either way, suppose that getting caught for cheating results in &lt;script type=&quot;math/tex&quot;&gt;-5&lt;/script&gt; on their grade, whereas not getting caught results in &lt;script type=&quot;math/tex&quot;&gt;+1&lt;/script&gt;. This is a bernoulli random variable with &lt;script type=&quot;math/tex&quot;&gt;p=0.02&lt;/script&gt;, and the expected value is &lt;script type=&quot;math/tex&quot;&gt;0.02 * -5 + 0.98 * 1 = 0.88&lt;/script&gt;. &lt;a href=&quot;#fnref:cheating-payoff&quot; class=&quot;reversefootnote&quot;&gt;⤴&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:2&quot;&gt;
      &lt;p&gt;Note that these incentives are still in place even without online testing; it’s just that cheating with proctors in person is probably much harder. &lt;a href=&quot;#fnref:2&quot; class=&quot;reversefootnote&quot;&gt;⤴&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:berkeleytime&quot;&gt;
      &lt;p&gt;Modelled off of Berkeleytime, &lt;a href=&quot;#fnref:berkeleytime&quot; class=&quot;reversefootnote&quot;&gt;⤴&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name>@addcninblue</name></author><summary type="html">In light of the recent changes of UC Berkeley’s grading scheme to P/NP, it’s quite interesting to examine the problem of grading through a Game Theoretic perspective. Lots of students have proposed that the change to an online format encourages cheating, and that the curves for this semester will change drastically as a result. In this essay, I hope to explore this claim and test its validity.</summary></entry><entry><title type="html">Random Fact #4</title><link href="https://addcnin.blue/2020/03/24/fact3/" rel="alternate" type="text/html" title="Random Fact #4" /><published>2020-03-24T00:00:00-07:00</published><updated>2020-03-24T00:00:00-07:00</updated><id>https://addcnin.blue/2020/03/24/fact3</id><content type="html" xml:base="https://addcnin.blue/2020/03/24/fact3/">&lt;h2 id=&quot;todays-fact-foot-on-water&quot;&gt;Today’s Fact: Foot On Water&lt;/h2&gt;
&lt;p&gt;Andi came up with an insane question: How wide does a human foot have to be for a human to stand on water? Of course, he came up with something insane, reproduced here.&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;foot-on-water-andi-gu&quot;&gt;Foot On Water, Andi Gu&lt;/h2&gt;

&lt;h3 id=&quot;relevant-parameters&quot;&gt;Relevant Parameters&lt;/h3&gt;

&lt;p&gt;Let &lt;script type=&quot;math/tex&quot;&gt;m&lt;/script&gt; be the mass of some person, let &lt;script type=&quot;math/tex&quot;&gt;R&lt;/script&gt; be the radius of his foot (which we model as a circle), and let &lt;script type=&quot;math/tex&quot;&gt;\gamma&lt;/script&gt; be the surface energy of water (i.e. surface tension).&lt;/p&gt;

&lt;p&gt;We make a simplistic model in which the water deforms in a circularly symmetric pattern around the foot, that when viewed at a cross-section appears as follows:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/facts/fact_4.png&quot; alt=&quot;watershape&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;derivation-of-foot-size&quot;&gt;Derivation of Foot Size&lt;/h3&gt;

&lt;p&gt;The increase in the water surface area is&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align*}
    \Delta A &amp;= \int_{R}^{R+\frac{h}{\tan \theta}} 2\pi r (\frac{1}{\cos \theta}-1) d{r} \\
    &amp;= \pi (\frac{h^2}{\tan^2 \theta} + \frac{2Rh}{\tan \theta}) \frac{1-\cos \theta}{\cos \theta}
\end{align*} %]]&gt;&lt;/script&gt;

&lt;p&gt;Since &lt;script type=&quot;math/tex&quot;&gt;\Delta E=\gamma \Delta A&lt;/script&gt;, we have:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align*}
    F_{up} &amp;= \frac{\partial E}{\partial h} \\
    &amp;= \gamma \pi (\frac{1-\cos \theta}{\cos \theta}) (\frac{2h}{\tan^2 \theta}+\frac{2R}{\tan \theta}) \\
    &amp;= 2\gamma\pi (\frac{1-\cos \theta}{\cos \theta}) (\frac{h+R \tan \theta}{\tan^2 \theta}) \\
    &amp;\approx 2\gamma \pi R \frac{1-\cos \theta}{\sin \theta}
\end{align*} %]]&gt;&lt;/script&gt;

&lt;p&gt;with the last step following since it is reasonable to assume &lt;script type=&quot;math/tex&quot;&gt;R \gg h&lt;/script&gt;&lt;/p&gt;

&lt;p&gt;The only remaining variable is &lt;script type=&quot;math/tex&quot;&gt;\theta&lt;/script&gt; – it is reasonable to assume a small angle &lt;script type=&quot;math/tex&quot;&gt;\theta&lt;/script&gt; (i.e. &lt;script type=&quot;math/tex&quot;&gt;\theta \approx \frac{\pi}{10}&lt;/script&gt;, so that this adds a factor of approximately 0.1). With &lt;script type=&quot;math/tex&quot;&gt;\gamma=72.8&lt;/script&gt; dynes per centimeter and &lt;script type=&quot;math/tex&quot;&gt;m=80&lt;/script&gt; kilograms, &lt;script type=&quot;math/tex&quot;&gt;R \approx 13 \text{km}&lt;/script&gt;.&lt;/p&gt;</content><author><name>@addcninblue</name></author><summary type="html">Today’s Fact: Foot On Water Andi came up with an insane question: How wide does a human foot have to be for a human to stand on water? Of course, he came up with something insane, reproduced here.</summary></entry><entry><title type="html">Random Fact #3</title><link href="https://addcnin.blue/2020/03/23/fact3/" rel="alternate" type="text/html" title="Random Fact #3" /><published>2020-03-23T00:00:00-07:00</published><updated>2020-03-23T00:00:00-07:00</updated><id>https://addcnin.blue/2020/03/23/fact3</id><content type="html" xml:base="https://addcnin.blue/2020/03/23/fact3/">&lt;h2 id=&quot;todays-fact-linear-discriminant-analysis&quot;&gt;Today’s Fact: Linear Discriminant Analysis&lt;/h2&gt;
&lt;p&gt;Linear Discriminant Analysis, or LDA for short, is an ML model used in classification. Specifically, for a model of &lt;code class=&quot;highlighter-rouge&quot;&gt;d&lt;/code&gt; features and &lt;code class=&quot;highlighter-rouge&quot;&gt;n&lt;/code&gt; training points, it assumes that the &lt;code class=&quot;highlighter-rouge&quot;&gt;d&lt;/code&gt; features are all distributed Normally (Gaussian), with the same variance. More formally, taken from my professor’s &lt;a href=&quot;https://people.eecs.berkeley.edu/~jrs/189/lec/07.pdf&quot;&gt;cs189 notes&lt;/a&gt;, we get:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/facts/fact2_1.png&quot; alt=&quot;Lecture Note 1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This doesn’t help much for those who are unfamiliar with Machine Learning, so he also included helpful diagrams. Below is a two-class classification (imagine your input is either of class &lt;code class=&quot;highlighter-rouge&quot;&gt;A&lt;/code&gt; or class &lt;code class=&quot;highlighter-rouge&quot;&gt;B&lt;/code&gt;, and you’re deciding which class it’s supposed to be in). The decision function (breaking point between choosing &lt;code class=&quot;highlighter-rouge&quot;&gt;A&lt;/code&gt; versus &lt;code class=&quot;highlighter-rouge&quot;&gt;B&lt;/code&gt;) is the black line; less than 0.5 indicates a stronger guess towards the left side, and greater than 0.5 indicates a stronger guess towards the right class. Below that, we have a multi-class problem, where each class’s boundaries are broken up by black line:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/facts/fact2_2.png&quot; alt=&quot;Lecture Note 2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;When Andi saw this, he immediately thought of &lt;a href=&quot;https://en.wikipedia.org/wiki/K-means_clustering&quot;&gt;k-means clustering&lt;/a&gt;, which is a type of unsupervised learning meant to cluster similar data without knowing their actual labels. K-means often uses similar voronoi diagrams to represent its output, so he raised a question: How does K-means compare to LDA, even though they fundamentally were quite different (supervised vs unsupervised, classification vs grouping)? And so we simulated it.&lt;/p&gt;

&lt;hr class=&quot;hr-subsection&quot; /&gt;

&lt;h3 id=&quot;simulation&quot;&gt;Simulation&lt;/h3&gt;

&lt;p&gt;First, we examined the case of Normally distributed data that is decently spread out from each other, like so:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/facts/fact2_1_data.png&quot; alt=&quot;Simulation 1, Data&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Here, we see that LDA and KMeans actually (somewhat surprisingly!) performed about the same:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/facts/fact2_1_kmeans.png&quot; alt=&quot;Simulation 1, KMeans&quot; /&gt;
&lt;img src=&quot;/assets/posts/facts/fact2_1_lda.png&quot; alt=&quot;Simulation 1, LDA&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Now, we looked at the case where data is overlapping, like so:
&lt;img src=&quot;/assets/posts/facts/fact2_2_data.png&quot; alt=&quot;Simulation 2, Data&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We see that the results are different this time (!):&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/facts/fact2_2_kmeans.png&quot; alt=&quot;Simulation 2, KMeans&quot; /&gt;
&lt;img src=&quot;/assets/posts/facts/fact2_2_lda.png&quot; alt=&quot;Simulation 2, LDA&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Notice that in the second case, where there are overlapping data, &lt;em&gt;LDA still learns of a distinction between class &lt;code class=&quot;highlighter-rouge&quot;&gt;Yellow&lt;/code&gt; and class &lt;code class=&quot;highlighter-rouge&quot;&gt;Purple&lt;/code&gt;&lt;/em&gt;. K-means completely lost it there, since it has no idea &lt;em&gt;what the labels are supposed to be&lt;/em&gt;. This is expected, since K-means is intended to group similar data, not learn things like this. We thought that it was quite interesting that K-means performed as well as it did in part 1.&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;addendum&quot;&gt;Addendum&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;/assets/posts/facts/fact2.ipynb&quot;&gt;Jupyter Notebook&lt;/a&gt;&lt;/p&gt;</content><author><name>@addcninblue</name></author><summary type="html">Today’s Fact: Linear Discriminant Analysis Linear Discriminant Analysis, or LDA for short, is an ML model used in classification. Specifically, for a model of d features and n training points, it assumes that the d features are all distributed Normally (Gaussian), with the same variance. More formally, taken from my professor’s cs189 notes, we get:</summary></entry><entry><title type="html">Random Fact #2</title><link href="https://addcnin.blue/2020/03/22/fact2/" rel="alternate" type="text/html" title="Random Fact #2" /><published>2020-03-22T00:00:00-07:00</published><updated>2020-03-22T00:00:00-07:00</updated><id>https://addcnin.blue/2020/03/22/fact2</id><content type="html" xml:base="https://addcnin.blue/2020/03/22/fact2/">&lt;h2 id=&quot;todays-fact-temperature-defined-statistically&quot;&gt;Today’s Fact: Temperature, Defined Statistically&lt;/h2&gt;
&lt;p&gt;TODO&lt;/p&gt;

&lt;p&gt;Note: This fact was actually discussed 3/23, but was moved to 3/22 for content’s sake.&lt;/p&gt;</content><author><name>@addcninblue</name></author><summary type="html">Today’s Fact: Temperature, Defined Statistically TODO</summary></entry><entry><title type="html">Random Fact #1</title><link href="https://addcnin.blue/2020/03/20/fact1/" rel="alternate" type="text/html" title="Random Fact #1" /><published>2020-03-20T00:00:00-07:00</published><updated>2020-03-20T00:00:00-07:00</updated><id>https://addcnin.blue/2020/03/20/fact1</id><content type="html" xml:base="https://addcnin.blue/2020/03/20/fact1/">&lt;h2 id=&quot;todays-fact-market-for-lemons&quot;&gt;Today’s Fact: Market for Lemons&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;/assets/posts/facts/fact1.png&quot; alt=&quot;Fact 1&quot; /&gt;
Source: Stat 155 Textbook, &lt;em&gt;Game Theory&lt;/em&gt; by Anna R. Karlin and Yuval Peres&lt;/p&gt;

&lt;h2 id=&quot;a-bit-of-background&quot;&gt;A Bit Of Background&lt;/h2&gt;
&lt;p&gt;The Coronavirus hit us all pretty hard. Now that school is moved online, and Berkeley classes have all been moved to P/NP, I’ve decided to take on the goal of finding one daily random fact with my friend &lt;a href=&quot;https://medium.com/@andi.gu.ca&quot;&gt;Andi Gu&lt;/a&gt;. Hopefully, whoever stumbles upon this blog will find them as interesting as we do!&lt;/p&gt;</content><author><name>@addcninblue</name></author><summary type="html">Today’s Fact: Market for Lemons Source: Stat 155 Textbook, Game Theory by Anna R. Karlin and Yuval Peres</summary></entry><entry><title type="html">Elixir Deployments and CPU Usage</title><link href="https://addcnin.blue/2020/03/03/elixir-performance/" rel="alternate" type="text/html" title="Elixir Deployments and CPU Usage" /><published>2020-03-03T00:00:00-08:00</published><updated>2020-03-03T00:00:00-08:00</updated><id>https://addcnin.blue/2020/03/03/elixir-performance</id><content type="html" xml:base="https://addcnin.blue/2020/03/03/elixir-performance/">&lt;h2 id=&quot;background&quot;&gt;Background&lt;/h2&gt;
&lt;p&gt;For the past semester, I have deployed &lt;a href=&quot;go.addcnin.blue/about&quot;&gt;a custom shortlinker service&lt;/a&gt; and my &lt;a href=&quot;addcnin.blue&quot;&gt;personal website&lt;/a&gt; on a &lt;a href=&quot;cloud.google.com&quot;&gt;Google Cloud Compute Free Instance&lt;/a&gt;. The custom shortlinker is a rewrite of the &lt;a href=&quot;https://github.com/Cal-CS-61A-Staff/links&quot;&gt;CS61A Shortlinker&lt;/a&gt; in Elixir, which was a good way for me to learn the new language. Upon deploying the Elixir version, however, I noticed that CPU usage hovered around a constant 100%, even the system was idling. I left it alone for a while, noting that it was responding to requests fairly quickly, leaving me to think that it was likely the BEAM that was idling.&lt;/p&gt;

&lt;h2 id=&quot;more-research&quot;&gt;More Research&lt;/h2&gt;
&lt;p&gt;Recently, I got back into Elixir, and curiosity (+ paying bills) prompted me to investigate into the issue more. I came across &lt;a href=&quot;https://stressgrid.com/blog/beam_cpu_usage/&quot;&gt;this blog&lt;/a&gt;, which answered all of my problems.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;… enabling busy waiting causes the CPU to be saturated above 95%. Disabling busy waiting causes CPU utilization to scale with the workload.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;That’s insane! Could it be possible that the BEAM was running empty cycles to claim the CPU, hence stealing cycles from other processes? There was only one way to tell.&lt;/p&gt;

&lt;h2 id=&quot;my-own-change&quot;&gt;My Own Change&lt;/h2&gt;
&lt;p&gt;I decided to make the changes the blog specified by adding these following lines to the BEAM arguments:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+sbwt none
+sbwtdcpu none
+sbwtdio none
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the blog, they used Distillery, but I use default Mix releases, so I will document the changes below:&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Documentation:
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://hexdocs.pm/mix/Mix.Tasks.Release.html&quot;&gt;Mix Release VM Documentation&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://github.com/addcninblue/links/commit/ddb45106492892c13834aeee20a83f47591bbf24#diff-f59a5941af2fadce5fbf5b04589acd10R12&quot;&gt;Change Commit&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Add the required VM configuration files: &lt;code class=&quot;highlighter-rouge&quot;&gt;mix release.init&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Modify the VM configuration file by adding
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; +sbwt none
 +sbwtdcpu none
 +sbwtdio none
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;to &lt;code class=&quot;highlighter-rouge&quot;&gt;rel/vm.args.eex&lt;/code&gt;.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;Recompile and deploy!&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;And with that, I noticed that there was a dramatic reduction in compute:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/posts/beam-reduced-usage.png&quot; alt=&quot;Beam Reduced Usage&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Note that CPU usage is &lt;em&gt;nearly zero&lt;/em&gt;, where as before it was ~100%! This frees up the CPU cycles for redeployments to this server and for more concurrent apps running (Build times are cut by &lt;strong&gt;more than a half!&lt;/strong&gt;). I will be monitoring this new deployment for any regressions, but it appears to be a very solid improvement.&lt;/p&gt;</content><author><name>@addcninblue</name></author><summary type="html">Background For the past semester, I have deployed a custom shortlinker service and my personal website on a Google Cloud Compute Free Instance. The custom shortlinker is a rewrite of the CS61A Shortlinker in Elixir, which was a good way for me to learn the new language. Upon deploying the Elixir version, however, I noticed that CPU usage hovered around a constant 100%, even the system was idling. I left it alone for a while, noting that it was responding to requests fairly quickly, leaving me to think that it was likely the BEAM that was idling.</summary></entry><entry><title type="html">EE375: A Coffee Chat</title><link href="https://addcnin.blue/2020/01/28/coffee/" rel="alternate" type="text/html" title="EE375: A Coffee Chat" /><published>2020-01-28T00:00:00-08:00</published><updated>2020-01-28T00:00:00-08:00</updated><id>https://addcnin.blue/2020/01/28/coffee</id><content type="html" xml:base="https://addcnin.blue/2020/01/28/coffee/">&lt;h2 id=&quot;introduction&quot;&gt;Introduction&lt;/h2&gt;
&lt;p&gt;Hello! This is a talk I gave at EE375, an introduction to teaching techniques class required at UC Berkeley for first-time TAs. The content is largely based on James Hoffman’s techniques, with inspiration from other famous figures. Since the talk was limited to 3 minutes, I skipped a lot of (quite lengthy) discussions, including coffee grind sizes, water ratios, and water temperature. If you have any questions about the material, feel free to email me!&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;main-lecture&quot;&gt;Main Lecture&lt;/h2&gt;

&lt;h3 id=&quot;000--045&quot;&gt;0:00 ~ 0:45&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Brief discussion of water ratio: 16.66 grams of water per gram of coffee
    &lt;ul&gt;
      &lt;li&gt;Practical terms: 250g/15g for one person, 500g/30g for two people&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Brief discussion of grind size:
    &lt;ul&gt;
      &lt;li&gt;Medium Fine (example shown in class)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Brief discussion of pouring method, assuming 250g/15g:
    &lt;ul&gt;
      &lt;li&gt;0:00 ~ 0:40 (45g): Bloom phase. This phase allows us to release CO2 from the coffee to allow for better extraction.&lt;/li&gt;
      &lt;li&gt;0:40 ~ 1:15 (150g): First pour. This phase is where we get most of our flavor from the coffee. We pour in a circular fashion to get the ground equally extracted.&lt;/li&gt;
      &lt;li&gt;1:15 ~ 1:45 (250g): Second pour. This phase is to allow for final extraction of the flavor. We pour in a straight fashion to keep the bed of water at a constant temperature, for even extraction.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;045--300&quot;&gt;0:45 ~ 3:00&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Demonstration of V60 Technique&lt;/li&gt;
  &lt;li&gt;Demonstrated technique: &lt;a href=&quot;https://www.youtube.com/watch?v=AI4ynXzkSQo&quot;&gt;James Hoffman’s Technique&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;additional-content&quot;&gt;Additional Content&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;Coffee dialing chart&lt;sup id=&quot;fnref:copyright&quot;&gt;&lt;a href=&quot;#fn:copyright&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;
&lt;img src=&quot;/assets/posts/coffee.jpg&quot; alt=&quot;Coffee&quot; /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;footnotes&quot;&gt;Footnotes&lt;/h2&gt;

&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:copyright&quot;&gt;
      &lt;p&gt;I do not own this material. This is a common coffee chart used by many coffee drinkers. &lt;a href=&quot;#fnref:copyright&quot; class=&quot;reversefootnote&quot;&gt;⤴&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name>@addcninblue</name></author><summary type="html">Introduction Hello! This is a talk I gave at EE375, an introduction to teaching techniques class required at UC Berkeley for first-time TAs. The content is largely based on James Hoffman’s techniques, with inspiration from other famous figures. Since the talk was limited to 3 minutes, I skipped a lot of (quite lengthy) discussions, including coffee grind sizes, water ratios, and water temperature. If you have any questions about the material, feel free to email me!</summary></entry><entry><title type="html">Summer/Fall 2019: Netskope</title><link href="https://addcnin.blue/2019/12/23/netskope/" rel="alternate" type="text/html" title="Summer/Fall 2019: Netskope" /><published>2019-12-23T01:29:20-08:00</published><updated>2019-12-23T01:29:20-08:00</updated><id>https://addcnin.blue/2019/12/23/netskope</id><content type="html" xml:base="https://addcnin.blue/2019/12/23/netskope/">&lt;h2 id=&quot;background&quot;&gt;Background&lt;/h2&gt;
&lt;p&gt;From May 2019 to January 2020, I worked at Netskope on the Data/Infra team, both in Santa Clara and in San Francisco. I learned a lot – both academically and professionally. I redesigned and partially rewrote a core part of their infrastructure, which eventually broke out into its own component that would be scaled up over time. This infrastructure was written in Go to replace their aging infrastructure in Python.&lt;/p&gt;

&lt;h2 id=&quot;internship&quot;&gt;Internship&lt;/h2&gt;
&lt;p&gt;During the internship, I worked on the component called &lt;em&gt;QueryService&lt;/em&gt; – a component that retrieves database data for UI components. In particular, I wrote out a crucial piece of infrastructure to support new databases (as we were migrating from the aging Mongo cluster we had) to support both Clickhouse and Google Cloud Platform (Bigquery). This piece of infrastructure was written in Go, which is a departure from the company’s main language of Python.&lt;/p&gt;

&lt;p&gt;When I started over the summer, I wrote the entire redesign of the service and checked in with several teams to find their pain points in using the in-house API. With the feedback, I generated pages of new API documentation. While this final API did not make it past the planning stage, the 19-page document serves as a great guide for future improvement to their current service.&lt;/p&gt;

&lt;p&gt;During the fall, the engineering team required better metrics, so we looked at Clickhouse and Bigquery as good aggregation tools. Using the code I wrote over the summer, we ported it over to be called as a separate service (from the current Python infrastructure), and we quickly scaled it up to support various existing queries (subgroupbys, aggregations, etc.). The main part I worked on during the Fall was dynamic database selection, where several preaggregated tables and collections would be available, and a request coming in would be matched to the table that would take the least computational time very quickly. This allowed us to not have to query the raw tables for all aggregations, which saved a tremendous amount of time.&lt;/p&gt;

&lt;h2 id=&quot;takeaways&quot;&gt;Takeaways&lt;/h2&gt;
&lt;p&gt;Food is great. I’ve never really realized, but it is pretty privileged to work in the Silicon Valley with perks that employees take for granted. People complain about the lunch selection, but it’s a great departure from worrying about the next meal in a college setting.&lt;/p&gt;

&lt;p&gt;Communication with teams halfway across the world is difficult. In the fall, my main team was located in India, so getting around a 8,000 mile barrier with a 12.5 hour time difference was pretty difficult. Calls were scheduled for any time between 8am and midnight. There were many times when I stepped in the office, pulled code from the repo, and found that something was broken. Since the team was asleep, I would have to work out the issue for a few hours before committing any useful work. Because of this, I came to appreciate working in an office and being able to call someone over at any time.&lt;/p&gt;

&lt;p&gt;Overall, the experience was really great – I learned a lot about industry technologies – Kubernetes, Docker, etc. – and worked with many different kinds of people from different backgrounds. Working in San Francisco was a great experience as well – while it was a lot to handle between a full load of classes and a 12 hour work week, it was definitely rewarding.&lt;/p&gt;</content><author><name>@addcninblue</name></author><summary type="html">Background From May 2019 to January 2020, I worked at Netskope on the Data/Infra team, both in Santa Clara and in San Francisco. I learned a lot – both academically and professionally. I redesigned and partially rewrote a core part of their infrastructure, which eventually broke out into its own component that would be scaled up over time. This infrastructure was written in Go to replace their aging infrastructure in Python.</summary></entry></feed>